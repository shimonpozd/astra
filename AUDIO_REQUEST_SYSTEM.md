# 🎵 Система запроса аудио из панелей

Теперь аудио плеер появляется **только по запросу** из панелей, а не автоматически после каждого сообщения.

## 🎯 Как это работает

### 1. **В панелях Workbench**
- Появилась кнопка **"Озвучить"** рядом с кнопкой проигрывания
- При нажатии открывается панель с выбором режима аудио
- Три варианта: быстрое воспроизведение, стриминг + сохранение, сообщение в чат

### 2. **В чате**
- Осталась только кнопка **"Слушать"** для быстрого воспроизведения
- Аудио плееры больше не появляются автоматически

## 🎛️ Компоненты системы

### **AudioRequestButton** - Кнопка запроса аудио
```tsx
<AudioRequestButton
  text="Текст для озвучки"
  chatId="chat-123"
  size="sm"
  variant="ghost"
/>
```

**Особенности:**
- 🎯 **Компактная** - помещается в заголовок панели
- 🎛️ **Выпадающая панель** - с выбором режима аудио
- 🔄 **Три режима** - быстрое, стриминг, сообщение

### **AudioRequestPanel** - Панель выбора режима
```tsx
<AudioRequestPanel
  text="Текст для озвучки"
  chatId="chat-123"
  onClose={() => setShowPanel(false)}
/>
```

**Режимы:**
1. **Быстрое воспроизведение** - `SimpleStreamingTTS`
2. **Стриминг + сохранение** - `StreamingAudioMessage`  
3. **Сообщение в чат** - `AudioTTSButton`

## 🎨 UI/UX

### **В панелях Workbench:**
```
[Перевести] [▶️ Проигрывать] [🎵 Озвучить] [🗑️ Очистить]
```

### **При нажатии "Озвучить":**
```
┌─────────────────────────────────────┐
│ 🎵 Озвучить текст              [×] │
├─────────────────────────────────────┤
│ Текст для озвучки...                │
├─────────────────────────────────────┤
│ [Быстрое] [Стриминг] [Сообщение]    │
└─────────────────────────────────────┘
```

### **Выбор режима:**
- **Быстрое** → `SimpleStreamingTTS` - мгновенное воспроизведение
- **Стриминг** → `StreamingAudioMessage` - с прогресс баром и сохранением
- **Сообщение** → `AudioTTSButton` - создание аудио сообщения в чате

## 🔧 Интеграция

### **В WorkbenchPanelInline:**
```tsx
// Добавлена кнопка аудио в заголовок
<AudioRequestButton
  text={textToPlay}
  size="sm"
  variant="ghost"
  className="w-8 h-8 p-0"
/>
```

### **В UnifiedMessageRenderer:**
```tsx
// Осталась только кнопка быстрого воспроизведения
<button onClick={handleSpeechify}>
  <Volume2 /> Слушать
</button>
```

## 🎯 Пользовательский опыт

### **Быстрое прослушивание:**
1. Пользователь видит текст в панели
2. Нажимает **"Озвучить"** 
3. Выбирает **"Быстрое воспроизведение"**
4. Аудио начинает играть сразу

### **Сохранение в чат:**
1. Пользователь нажимает **"Озвучить"**
2. Выбирает **"Сообщение в чат"**
3. Создается аудио сообщение в чате
4. Можно переслушивать и скачивать

### **Стриминг с контролем:**
1. Пользователь выбирает **"Стриминг + сохранение"**
2. Появляется плеер с прогресс баром
3. Можно паузировать, перематывать
4. Можно сохранить в чат

## 🚀 Преимущества

✅ **Чистый интерфейс** - аудио плееры не засоряют чат  
✅ **По запросу** - аудио появляется только когда нужно  
✅ **Выбор режима** - пользователь сам решает, что делать  
✅ **Интеграция с панелями** - логично размещено в рабочей области  
✅ **Гибкость** - три уровня функциональности  

## 🎵 Результат

Теперь система работает **интуитивно**:

- **В чате** - только быстрые кнопки "Слушать"
- **В панелях** - полный контроль с кнопкой "Озвучить"
- **По запросу** - аудио появляется только когда нужно
- **Выбор режима** - пользователь сам решает уровень функциональности

Пользователи получают **чистый интерфейс** с возможностью **полного контроля** над аудио! 🎯🎵


