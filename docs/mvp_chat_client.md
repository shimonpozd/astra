# MVP –í–µ–±-–∫–ª–∏–µ–Ω—Ç –¥–ª—è —á–∞—Ç–∞ Astra

## üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –∑–∞–º–µ–Ω—É CLI-–∫–ª–∏–µ–Ω—Ç—É - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å Astra —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è MVP

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ –æ–∫–Ω–æ —á–∞—Ç–∞
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω—ã
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

### –ù–µ –Ω—É–∂–Ω–æ –ø–æ–∫–∞
- ‚ùå –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–æ–≤
- ‚ùå –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- ‚ùå –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Frontend
- **React 18** - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Vite** - –±—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ –∏ dev server
- **TypeScript** - —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- **Tailwind CSS** - —Å—Ç–∏–ª–∏
- **shadcn/ui** - –≥–æ—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Backend
- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π **Brain API** –Ω–∞ –ø–æ—Ä—Ç—É 7030
- –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã: `/chat/stream`, `/chat/text`

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
astra-web-client/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Chat.tsx          # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —á–∞—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Message.tsx       # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PersonaSelector.tsx # –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ModelSettings.tsx # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.ts           # API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts         # –¢–∏–ø—ã TypeScript
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx              # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ main.tsx            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ public/
‚îú‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ vite.config.ts
‚îî‚îÄ‚îÄ tailwind.config.js
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–∑–¥–∞—Ç—å React –ø—Ä–æ–µ–∫—Ç —Å Vite
npm create vite@latest astra-web-client -- --template react-ts
cd astra-web-client
npm install
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install axios
npm install lucide-react  # –¥–ª—è –∏–∫–æ–Ω–æ–∫
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Tailwind (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
```

### 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

**src/App.tsx** - –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:

```tsx
import { useState } from 'react';
import Chat from './components/Chat';
import PersonaSelector from './components/PersonaSelector';
import ModelSettings from './components/ModelSettings';

function App() {
  const [selectedPersona, setSelectedPersona] = useState('default');
  const [modelSettings, setModelSettings] = useState({
    temperature: 0.7,
    maxTokens: 2000
  });

  return (
    <div className="h-screen flex flex-col bg-gray-50">
      {/* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å */}
      <header className="bg-white border-b p-4">
        <div className="flex justify-between items-center">
          <h1 className="text-xl font-bold">Astra Chat</h1>
          <div className="flex gap-4">
            <PersonaSelector
              selected={selectedPersona}
              onSelect={setSelectedPersona}
            />
            <ModelSettings
              settings={modelSettings}
              onChange={setModelSettings}
            />
          </div>
        </div>
      </header>

      {/* –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ */}
      <main className="flex-1 overflow-hidden">
        <Chat
          persona={selectedPersona}
          modelSettings={modelSettings}
        />
      </main>
    </div>
  );
}

export default App;
```

**src/components/Chat.tsx** - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —á–∞—Ç–∞:

```tsx
import { useState, useRef, useEffect } from 'react';
import Message from './Message';
import { api } from '../services/api';

interface ChatProps {
  persona: string;
  modelSettings: any;
}

interface Message {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: Date;
}

export default function Chat({ persona, modelSettings }: ChatProps) {
  const [messages, setMessages] = useState<Message[]>([]);
  const [input, setInput] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const sendMessage = async () => {
    if (!input.trim() || isLoading) return;

    const userMessage: Message = {
      id: Date.now().toString(),
      role: 'user',
      content: input,
      timestamp: new Date()
    };

    setMessages(prev => [...prev, userMessage]);
    setInput('');
    setIsLoading(true);

    try {
      const response = await api.sendMessage({
        text: input,
        agent_id: persona,
        ...modelSettings
      });

      const assistantMessage: Message = {
        id: (Date.now() + 1).toString(),
        role: 'assistant',
        content: response,
        timestamp: new Date()
      };

      setMessages(prev => [...prev, assistantMessage]);
    } catch (error) {
      console.error('Error sending message:', error);
      const errorMessage: Message = {
        id: (Date.now() + 1).toString(),
        role: 'assistant',
        content: '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è',
        timestamp: new Date()
      };
      setMessages(prev => [...prev, errorMessage]);
    } finally {
      setIsLoading(false);
    }
  };

  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  };

  return (
    <div className="h-full flex flex-col">
      {/* –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π */}
      <div className="flex-1 overflow-y-auto p-4 space-y-4">
        {messages.map((message) => (
          <Message key={message.id} message={message} />
        ))}
        {isLoading && (
          <div className="text-gray-500">–ü–µ—á–∞—Ç–∞–µ—Ç...</div>
        )}
        <div ref={messagesEndRef} />
      </div>

      {/* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */}
      <div className="border-t p-4 bg-white">
        <div className="flex gap-2">
          <textarea
            value={input}
            onChange={(e) => setInput(e.target.value)}
            onKeyPress={handleKeyPress}
            placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
            className="flex-1 p-2 border rounded-lg resize-none"
            rows={3}
          />
          <button
            onClick={sendMessage}
            disabled={!input.trim() || isLoading}
            className="px-4 py-2 bg-blue-500 text-white rounded-lg disabled:opacity-50"
          >
            –û—Ç–ø—Ä–∞–≤–∏—Ç—å
          </button>
        </div>
      </div>
    </div>
  );
}
```

**src/components/Message.tsx** - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:

```tsx
interface MessageProps {
  message: {
    id: string;
    role: 'user' | 'assistant';
    content: string;
    timestamp: Date;
  };
}

export default function Message({ message }: MessageProps) {
  const isUser = message.role === 'user';

  return (
    <div className={`flex ${isUser ? 'justify-end' : 'justify-start'}`}>
      <div
        className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${
          isUser
            ? 'bg-blue-500 text-white'
            : 'bg-gray-200 text-gray-900'
        }`}
      >
        <p className="whitespace-pre-wrap">{message.content}</p>
        <p className={`text-xs mt-1 ${
          isUser ? 'text-blue-100' : 'text-gray-500'
        }`}>
          {message.timestamp.toLocaleTimeString()}
        </p>
      </div>
    </div>
  );
}
```

**src/components/PersonaSelector.tsx** - –≤—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω—ã:

```tsx
import { useState, useEffect } from 'react';

interface PersonaSelectorProps {
  selected: string;
  onSelect: (persona: string) => void;
}

export default function PersonaSelector({ selected, onSelect }: PersonaSelectorProps) {
  const [personas, setPersonas] = useState<string[]>(['default']);

  useEffect(() => {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä—Å–æ–Ω—ã –∏–∑ personalities.json
    fetch('/personalities.json')
      .then(res => res.json())
      .then(data => setPersonas(Object.keys(data)))
      .catch(err => console.error('Error loading personas:', err));
  }, []);

  return (
    <select
      value={selected}
      onChange={(e) => onSelect(e.target.value)}
      className="px-3 py-1 border rounded"
    >
      {personas.map(persona => (
        <option key={persona} value={persona}>
          {persona}
        </option>
      ))}
    </select>
  );
}
```

**src/components/ModelSettings.tsx** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏:

```tsx
interface ModelSettingsProps {
  settings: {
    temperature: number;
    maxTokens: number;
  };
  onChange: (settings: any) => void;
}

export default function ModelSettings({ settings, onChange }: ModelSettingsProps) {
  return (
    <div className="flex gap-4 items-center">
      <div>
        <label className="block text-sm">Temperature</label>
        <input
          type="range"
          min="0"
          max="2"
          step="0.1"
          value={settings.temperature}
          onChange={(e) => onChange({
            ...settings,
            temperature: parseFloat(e.target.value)
          })}
          className="w-20"
        />
        <span className="text-sm">{settings.temperature}</span>
      </div>

      <div>
        <label className="block text-sm">Max Tokens</label>
        <input
          type="number"
          value={settings.maxTokens}
          onChange={(e) => onChange({
            ...settings,
            maxTokens: parseInt(e.target.value)
          })}
          className="w-20 px-2 py-1 border rounded"
        />
      </div>
    </div>
  );
}
```

**src/services/api.ts** - API –∫–ª–∏–µ–Ω—Ç:

```typescript
const API_BASE = 'http://localhost:7030';

export const api = {
  async sendMessage(data: {
    text: string;
    agent_id: string;
    temperature?: number;
    maxTokens?: number;
  }): Promise<string> {
    const response = await fetch(`${API_BASE}/chat/text`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    const result = await response.json();
    return result.reply;
  },

  async sendMessageStream(data: {
    text: string;
    agent_id: string;
    temperature?: number;
    maxTokens?: number;
  }): Promise<ReadableStream<Uint8Array>> {
    const response = await fetch(`${API_BASE}/chat/stream`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    });

    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }

    return response.body!;
  }
};
```

## üé® –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è

**tailwind.config.js**:

```js
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

**src/index.css**:

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
}
```

## üöÄ –ó–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
cd astra-web-client
npm install
npm run dev
```

### 2. –î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é

- **Frontend**: http://localhost:5173
- **Backend (Brain)**: http://localhost:7030

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ API

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Brain —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
curl http://localhost:7030/
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API

–í `src/services/api.ts` –∏–∑–º–µ–Ω–∏—Ç—å `API_BASE` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:
```typescript
const API_BASE = 'http://localhost:7030'; // –∏–ª–∏ –≤–∞—à –∞–¥—Ä–µ—Å
```

### 2. –ü–µ—Ä—Å–æ–Ω—ã

–ü–µ—Ä—Å–æ–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ `/personalities.json` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª –¥–æ—Å—Ç—É–ø–µ–Ω.

## üì± –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ –∏ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- Touch-friendly –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ü—Ä–æ—Å—Ç–æ—Ç–∞
- –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω
- –¢–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç—ã
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏
- –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üîÑ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ

–ü–æ—Å–ª–µ MVP –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–æ–≤
- Drag & drop —Ñ–∞–π–ª–æ–≤
- –¢–µ–º—ã (—Å–≤–µ—Ç–ª–∞—è/—Ç–µ–º–Ω–∞—è)
- –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

MVP –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π –∑–∞–º–µ–Ω–æ–π CLI-–∫–ª–∏–µ–Ω—Ç—É —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

–•–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ MVP?