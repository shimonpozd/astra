# План дальнейших действий по проекту "Астра"

Этот документ описывает следующие шаги по улучшению и развитию системы.

## 1. Критические исправления и улучшения

*   **Решить проблему с подключением к сервису памяти:** Необходимо окончательно диагностировать и устранить ошибку `httpx.ConnectError`, которая возникает при обращении из сервиса `brain` к сервису `memory`. Это первоочередная задача, блокирующая дальнейшую работу.
*   **Отправка финального ответа:** Реализовать отправку полного, готового ответа (финального `draft`) из `deepresearch` flow, а не только отдельных частей.
*   **Разделить логику `conversational` и `deepresearch`:** Устранить проблему, при которой переход в режим исследования как будто "очищает" текущий чат. Необходимо сделать так, чтобы можно было бесшовно переключаться между обсуждением и исследованием, а также вести диалог с уже полученными результатами исследования.

## 2. Улучшения веб-интерфейса (UI/UX)

*   **Отображение процесса мышления:** Реализовать в веб-клиенте отображение тегов `<think>`, критики и других промежуточных шагов. Это позволит лучше понимать, что делает агент на каждом этапе.
*   **Улучшение шрифтов:** Добавить и применять шрифт "Noto Rashi Hebrew" для комментариев Раши и, возможно, других классических комментаторов.
*   **Связь источников и саммари:** Реализовать в интерфейсе визуальную связь между источником (цитатой) и его кратким изложением (summary). Например, при клике на источник может появляться его саммари.
*   **Назначение областей интерфейса:** Использовать основное окно (где сейчас отображаются источники) для вывода структурированной информации (источники, саммари, связи), а окно чата — для отображения "живого" процесса работы ассистента (теги `<think>`, критика, промежуточные черновики).

## 3. Развитие исследовательской функциональности

*   **Диалог с базой знаний:** Создать возможность вести диалог с результатами проведенного исследования. После того как система собрала и сохранила информацию, пользователь должен иметь возможность задавать уточняющие вопросы. Агент, в свою очередь, должен уметь снова использовать инструменты для поиска ответов в уже собранной базе данных.
*   **Сессия изучения:** Развить концепцию "сессии изучения", которая не ограничивается одним фрагментом, а охватывает целую тему или раздел (например, главу Талмуда).

## 4. Долгосрочное видение и цели

*   **Универсальный помощник для изучения Торы:** Развивать инструмент как универсального помощника для изучения различных текстов: Талмуд, Пятикнижие, Пророки и т.д.
*   **Режим "пословного" перевода и озвучивания:** Реализовать функцию, которая позволяет идти по тексту (например, по стихам Торы), получать перевод каждого стиха и его озвучку.
*   **Генерация итоговых статей:** Улучшить функционал создания итоговой статьи (`drasha`) со всеми комментариями (`мефоршим`), чтобы она была более структурированной и полной.
